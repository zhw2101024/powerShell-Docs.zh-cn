---
title: Windows PowerShell 错误记录 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.assetid: bdd66fea-eb63-4bb6-9cbe-9a799e5e0db5
caps.latest.revision: 9
ms.openlocfilehash: 5412d88b690a1f5f1ef387416e3bf9da3a32c95d
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/15/2019
ms.locfileid: "72369106"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="27efd-102">Windows PowerShell 错误记录</span><span class="sxs-lookup"><span data-stu-id="27efd-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="27efd-103">Cmdlet 必须传递一个[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象，该对象标识用于终止和非终止错误的错误条件。</span><span class="sxs-lookup"><span data-stu-id="27efd-103">Cmdlets must pass an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="27efd-104">[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象包含下面的信息：</span><span class="sxs-lookup"><span data-stu-id="27efd-104">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="27efd-105">描述错误的异常。</span><span class="sxs-lookup"><span data-stu-id="27efd-105">The exception that describes the error.</span></span> <span data-ttu-id="27efd-106">通常，这是 cmdlet 捕获并转换为错误记录的异常。</span><span class="sxs-lookup"><span data-stu-id="27efd-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="27efd-107">每个错误记录都必须包含一个异常。</span><span class="sxs-lookup"><span data-stu-id="27efd-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="27efd-108">如果 cmdlet 未捕获异常，则它必须创建新的异常，并选择最能描述错误情况的异常类。</span><span class="sxs-lookup"><span data-stu-id="27efd-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="27efd-109">但是，您不需要引发异常，因为它可以通过[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象的[ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)属性进行访问，这是因为它是可访问的。</span><span class="sxs-lookup"><span data-stu-id="27efd-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.ErrorRecord.Exception](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="27efd-110">错误标识符，提供可用于诊断目的的目标标识符，以及用于处理特定错误处理程序的特定错误条件的 Windows PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="27efd-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="27efd-111">每个错误记录都必须包含错误标识符（请参阅错误标识符）。</span><span class="sxs-lookup"><span data-stu-id="27efd-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="27efd-112">一个错误类别，提供可用于诊断目的的常规指示符。</span><span class="sxs-lookup"><span data-stu-id="27efd-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="27efd-113">每个错误记录必须指定错误类别（请参阅错误类别）。</span><span class="sxs-lookup"><span data-stu-id="27efd-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="27efd-114">可选的替换错误消息和建议的操作（请参阅替换错误消息）。</span><span class="sxs-lookup"><span data-stu-id="27efd-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="27efd-115">有关引发错误的 cmdlet 的可选调用信息。</span><span class="sxs-lookup"><span data-stu-id="27efd-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="27efd-116">此信息由 Windows PowerShell 指定（请参阅调用消息）。</span><span class="sxs-lookup"><span data-stu-id="27efd-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="27efd-117">发生错误时正在处理的目标对象。</span><span class="sxs-lookup"><span data-stu-id="27efd-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="27efd-118">这可能是输入对象，也可能是 cmdlet 正在处理的另一个对象。</span><span class="sxs-lookup"><span data-stu-id="27efd-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="27efd-119">例如，对于命令 `remove-item -recurse c:\somedirectory`，该错误可能是 "c:\somedirectory\lockedfile" 的 FileInfo 对象的实例。</span><span class="sxs-lookup"><span data-stu-id="27efd-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="27efd-120">目标对象信息是可选的。</span><span class="sxs-lookup"><span data-stu-id="27efd-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="27efd-121">错误标识符</span><span class="sxs-lookup"><span data-stu-id="27efd-121">Error Identifier</span></span>

<span data-ttu-id="27efd-122">创建错误记录时，请指定在 cmdlet 中指定错误条件的标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="27efd-123">Windows PowerShell 将目标标识符与 cmdlet 的名称相结合，以创建完全限定的错误标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="27efd-124">完全限定的错误标识符可以通过 [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) 对象的 [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) 属性进行访问。</span><span class="sxs-lookup"><span data-stu-id="27efd-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.ErrorRecord.FullyQualifiedErrorId](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="27efd-125">错误标识符本身不可用。</span><span class="sxs-lookup"><span data-stu-id="27efd-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="27efd-126">它仅可用作完全限定的错误标识符的一部分。</span><span class="sxs-lookup"><span data-stu-id="27efd-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="27efd-127">创建错误记录时，使用以下准则生成错误标识符：</span><span class="sxs-lookup"><span data-stu-id="27efd-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="27efd-128">使错误标识符特定于错误条件。</span><span class="sxs-lookup"><span data-stu-id="27efd-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="27efd-129">针对诊断目的指定错误标识符，并针对处理特定错误处理程序的特定错误条件的脚本进行定位。</span><span class="sxs-lookup"><span data-stu-id="27efd-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="27efd-130">用户应能够使用错误标识符来标识错误及其源。</span><span class="sxs-lookup"><span data-stu-id="27efd-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="27efd-131">错误标识符还启用了从现有异常中报告特定错误条件，以便不需要新的异常子类。</span><span class="sxs-lookup"><span data-stu-id="27efd-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="27efd-132">通常，将不同的错误标识符分配给不同的代码路径。</span><span class="sxs-lookup"><span data-stu-id="27efd-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="27efd-133">最终用户将受益于特定标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="27efd-134">通常情况下，调用[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)的每个代码路径都有其自己的标识符）。</span><span class="sxs-lookup"><span data-stu-id="27efd-134">Often, each code path that calls [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="27efd-135">通常，在为错误消息定义新的模板字符串时定义新的标识符，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="27efd-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="27efd-136">不要将错误消息用作标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="27efd-137">当你使用特定的错误标识符发布代码时，将使用该标识符为完整的产品支持生命周期建立错误的语义。</span><span class="sxs-lookup"><span data-stu-id="27efd-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="27efd-138">不要在语义不同于原始上下文的上下文中重用它。</span><span class="sxs-lookup"><span data-stu-id="27efd-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="27efd-139">如果此错误的语义发生更改，请创建并使用新的标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="27efd-140">通常应仅对特定 CLR 类型的异常使用特定的错误标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="27efd-141">如果异常的类型或目标对象的类型发生更改，请创建并使用新的标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="27efd-142">选择您的错误标识符文本，该文本将简明扼要地对应于要报告的错误。</span><span class="sxs-lookup"><span data-stu-id="27efd-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="27efd-143">使用标准 .NET Framework 命名和大小写约定。</span><span class="sxs-lookup"><span data-stu-id="27efd-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="27efd-144">不要使用空格或标点。</span><span class="sxs-lookup"><span data-stu-id="27efd-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="27efd-145">不要本地化错误标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="27efd-146">不要以无法重现的方式动态生成错误标识符。</span><span class="sxs-lookup"><span data-stu-id="27efd-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="27efd-147">例如，不要合并错误信息，如进程 ID。</span><span class="sxs-lookup"><span data-stu-id="27efd-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="27efd-148">仅当错误标识符对应于遇到相同错误情况的其他用户所见到的错误标识符时，错误标识符才有用。</span><span class="sxs-lookup"><span data-stu-id="27efd-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="27efd-149">错误类别</span><span class="sxs-lookup"><span data-stu-id="27efd-149">Error Category</span></span>

<span data-ttu-id="27efd-150">当你创建错误记录时，使用[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)枚举定义的其中一个常量指定错误的类别。</span><span class="sxs-lookup"><span data-stu-id="27efd-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) enumeration.</span></span> <span data-ttu-id="27efd-151">当用户将 `$ErrorView` 变量设置为 `"CategoryView"` 时，Windows PowerShell 使用错误类别显示错误信息。</span><span class="sxs-lookup"><span data-stu-id="27efd-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="27efd-152">避免使用[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified**常数。</span><span class="sxs-lookup"><span data-stu-id="27efd-152">Avoid using the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) **NotSpecified** constant.</span></span> <span data-ttu-id="27efd-153">如果有关于错误的任何信息或有关导致错误的操作的信息，请选择最能描述错误或操作的类别，即使该类别不是完全匹配。</span><span class="sxs-lookup"><span data-stu-id="27efd-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="27efd-154">Windows PowerShell 显示的信息称为类别视图字符串，是从[Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)类的属性中生成的，它是从</span><span class="sxs-lookup"><span data-stu-id="27efd-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="27efd-155">（此类通过错误[ErrorRecord. CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)属性访问。）</span><span class="sxs-lookup"><span data-stu-id="27efd-155">(This class is accessed through the error [System.Management.Automation.ErrorRecord.CategoryInfo](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="27efd-156">以下列表描述了显示的信息：</span><span class="sxs-lookup"><span data-stu-id="27efd-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="27efd-157">类别：Windows PowerShell 定义的[ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)常量。</span><span class="sxs-lookup"><span data-stu-id="27efd-157">Category: A Windows PowerShell-defined [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0) constant.</span></span>

- <span data-ttu-id="27efd-158">TargetName默认情况下，该 cmdlet 在发生错误时正在处理的对象的名称。</span><span class="sxs-lookup"><span data-stu-id="27efd-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="27efd-159">或其他 cmdlet 定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="27efd-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="27efd-160">TargetType默认情况下，目标对象的类型。</span><span class="sxs-lookup"><span data-stu-id="27efd-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="27efd-161">或其他 cmdlet 定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="27efd-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="27efd-162">活动默认情况下，创建错误记录的 cmdlet 的名称。</span><span class="sxs-lookup"><span data-stu-id="27efd-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="27efd-163">或其他 cmdlet 定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="27efd-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="27efd-164">原因：默认情况下，异常类型。</span><span class="sxs-lookup"><span data-stu-id="27efd-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="27efd-165">或其他 cmdlet 定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="27efd-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="27efd-166">替换错误消息</span><span class="sxs-lookup"><span data-stu-id="27efd-166">Replacement Error Message</span></span>

<span data-ttu-id="27efd-167">当你为某个 cmdlet 开发错误记录时，该错误的默认错误消息将来自[system.exception 属性中](/dotnet/api/System.Exception.Message)的默认消息文本。</span><span class="sxs-lookup"><span data-stu-id="27efd-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="27efd-168">这是一个只读属性，其消息文本仅用于调试目的（根据 .NET Framework 准则）。</span><span class="sxs-lookup"><span data-stu-id="27efd-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="27efd-169">建议创建一个错误消息来替换或扩充默认消息文本。</span><span class="sxs-lookup"><span data-stu-id="27efd-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="27efd-170">使消息更易于用户理解，更具针对性于 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="27efd-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="27efd-171">替换消息是由[ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)对象提供的。</span><span class="sxs-lookup"><span data-stu-id="27efd-171">The replacement message is provided by an [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="27efd-172">使用此对象的以下构造函数之一，因为它们提供了可供 Windows PowerShell 使用的其他本地化信息。</span><span class="sxs-lookup"><span data-stu-id="27efd-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="27efd-173">[ErrorDetails （Cmdlet，string，string，Object []）](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___)：如果模板字符串是在其中实现了 cmdlet 的同一程序集中的资源字符串，或者如果要通过[GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)方法的重写加载模板字符串，请使用此构造函数.</span><span class="sxs-lookup"><span data-stu-id="27efd-173">[ErrorDetails(Cmdlet, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Management_Automation_Cmdlet_System_String_System_String_System_Object___): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="27efd-174">[ErrorDetails （Assembly，string，string，Object []）](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___)：如果模板字符串在另一个程序集中，并且不通过重写[GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)来加载它，请使用此构造函数。</span><span class="sxs-lookup"><span data-stu-id="27efd-174">[ErrorDetails(Assembly, String, String, Object[])](/dotnet/api/system.management.automation.errordetails.-ctor?view=pscore-6.2.0#System_Management_Automation_ErrorDetails__ctor_System_Reflection_Assembly_System_String_System_String_System_Object___): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.GetResourceString](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="27efd-175">替换消息应该符合 .NET Framework 的设计准则，用于编写少量的异常消息。</span><span class="sxs-lookup"><span data-stu-id="27efd-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="27efd-176">准则表明应为开发人员编写异常消息。</span><span class="sxs-lookup"><span data-stu-id="27efd-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="27efd-177">应为 cmdlet 用户编写这些替换消息。</span><span class="sxs-lookup"><span data-stu-id="27efd-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="27efd-178">在调用[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)方法之前，必须先添加替换错误消息，然后再将其添加。</span><span class="sxs-lookup"><span data-stu-id="27efd-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="27efd-179">若要添加替代消息，请设置错误记录的[ErrorRecord. ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)属性。</span><span class="sxs-lookup"><span data-stu-id="27efd-179">To add a replacement message, set the [System.Management.Automation.ErrorRecord.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="27efd-180">设置此属性后，Windows PowerShell 会显示[ErrorDetails \*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)属性，而不是默认消息文本。</span><span class="sxs-lookup"><span data-stu-id="27efd-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.ErrorDetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="27efd-181">建议的操作信息</span><span class="sxs-lookup"><span data-stu-id="27efd-181">Recommended Action Information</span></span>

<span data-ttu-id="27efd-182">[ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails)对象还可以提供有关在发生错误时建议的操作的信息。</span><span class="sxs-lookup"><span data-stu-id="27efd-182">The [System.Management.Automation.ErrorDetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="27efd-183">调用信息</span><span class="sxs-lookup"><span data-stu-id="27efd-183">Invocation information</span></span>

<span data-ttu-id="27efd-184">当某个 cmdlet 使用[WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[Throwterminatingerror \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)来报告错误记录时，Windows PowerShell 会自动添加描述该内容的信息，这些发生错误时调用的命令。</span><span class="sxs-lookup"><span data-stu-id="27efd-184">When a cmdlet uses [System.Management.Automation.Cmdlet.WriteError](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="27efd-185">此信息由[Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)对象提供，该对象包含命令调用的 cmdlet 的名称、命令本身，以及有关管道或脚本的信息。</span><span class="sxs-lookup"><span data-stu-id="27efd-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="27efd-186">此属性是只读的。</span><span class="sxs-lookup"><span data-stu-id="27efd-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="27efd-187">另请参阅</span><span class="sxs-lookup"><span data-stu-id="27efd-187">See Also</span></span>

[<span data-ttu-id="27efd-188">"WriteError"。</span><span class="sxs-lookup"><span data-stu-id="27efd-188">System.Management.Automation.Cmdlet.WriteError</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="27efd-189">Throwterminatingerror \* 的 \*</span><span class="sxs-lookup"><span data-stu-id="27efd-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="27efd-190">System.web. ErrorCategory</span><span class="sxs-lookup"><span data-stu-id="27efd-190">System.Management.Automation.ErrorCategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory?view=pscore-6.2.0)

[<span data-ttu-id="27efd-191">System.web. Errorcategoryinfo</span><span class="sxs-lookup"><span data-stu-id="27efd-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="27efd-192">System.web. ErrorRecord</span><span class="sxs-lookup"><span data-stu-id="27efd-192">System.Management.Automation.ErrorRecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="27efd-193">System.web. ErrorDetails</span><span class="sxs-lookup"><span data-stu-id="27efd-193">System.Management.Automation.ErrorDetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="27efd-194">System.web. Invocationinfo</span><span class="sxs-lookup"><span data-stu-id="27efd-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="27efd-195">Windows PowerShell 错误报告</span><span class="sxs-lookup"><span data-stu-id="27efd-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="27efd-196">编写 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="27efd-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
